{{ 'announcement-bar.css' | asset_url | stylesheet_tag }}
<div 
class="main_announcement_bar color-{{ section.settings.color_scheme }} flickity-parent">
 
  <div class="splide" id="announcement-splide" aria-labelledby="carousel-heading">  
    <div class="splide__track">
      <ul class="splide__list">
        {%- for block in section.blocks -%}
          <li class="splide__slide">
            {%- case block.type -%}
              {%- when 'announcement' -%}
                <div
                  class="announcement-bar"
                  role="region"
                  aria-label="{{ 'sections.header.announcement' | t }}"
                  {{ block.shopify_attributes }}
                  {% if block.settings.tracking_id != blank %} data-tracking-id="{{ block.settings.tracking_id }}"{% endif %}
                  {% if block.settings.tracking_name != blank %} data-tracking-name="{{ block.settings.tracking_name }}" {% endif %}
                  {% if block.settings.tracking_creative != blank %} data-tracking-creative="{{ block.settings.tracking_creative }}" {% endif %}
                  {% if block.settings.tracking_position != blank %} data-tracking-position="{{ block.settings.tracking_position }}" {% endif %}>
                  {%- if block.settings.text != blank -%}
                    {%- if block.settings.link != blank -%}
                      <a
                        href="{{ block.settings.link }}"
                        class="announcement-bar__link link link--text focus-inset animate-arrow"
                      >
                    {%- endif -%}
                    <div class="page-width announcement-text">
                        {{ block.settings.text }}
                    </div>
                    {%- if block.settings.link != blank -%}
                      </a>
                    {%- endif -%}
                  {%- endif -%}
                </div>
            {%- endcase -%}
          </li> 
        {% endfor %}      
      </ul>
    </div>
  </div> 
</div>
<div class="announcement-close-btn">
  {% render 'icon' with 'close-with-border' %}
</div>

<script defer>
  const closeBtn = document.querySelector('.announcement-close-btn');
  closeBtn.addEventListener('click', (ev) => {
    ev.preventDefault();
    const announcementBar = document.querySelector('.main_announcement_bar');
    announcementBar.classList.add('hidden');
    closeBtn.classList.add('hidden');
  });  
</script>



{% schema %}
{
  "name": "t:sections.announcement-bar.name",
  "max_blocks": 12,
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "accent-1"
    },
    {
      "type": "range",
      "id": "change_slides_speed",
      "min": 3,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "t:sections.announcement-bar.settings.change_slides_speed.label",
      "default": 5
    }
  ], 
  "blocks": [
    {
      "type": "announcement",
      "name": "t:sections.announcement-bar.blocks.announcement.name",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "default": "<p> Welcome to our store</p>",
          "label": "t:sections.announcement-bar.blocks.announcement.settings.text.label"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:sections.announcement-bar.blocks.announcement.settings.link.label"
        },
        {
          "type": "header",
          "content": "Tracking Details (Desktop)"
        },
        {
          "type": "text",
          "id": "tracking_id",
          "label": "ID",
          "info": "Example: JUNE_PROMO13"
        },
        {
          "type": "text",
          "id": "tracking_name",
          "label": "Name",
          "info": "Example: June Sale"
        },
        {
          "type": "text",
          "id": "tracking_creative",
          "label": "Creative",
          "info": "Example: banner1"
        },
        {
          "type": "text",
          "id": "tracking_position",
          "label": "Position",
          "info": "Example: slot1"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.announcement-bar.presets.name",
      "blocks": [
        {
          "type": "announcement"
        }
      ]
    }
  ]
}
{% endschema %}
