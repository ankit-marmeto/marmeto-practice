{% layout none %}
{%- paginate collection.products by 24 -%}
  {% if collection.products.size > 0 %}
    <ul
      id="product-grid"
      data-id="{{ section.id }}"
      class="grid product-grid grid--{{ section.settings.columns_mobile }}-col-tablet-down grid--{{ section.settings.columns_desktop }}-col-desktop grid-layout--4"
      data-tag="{{ section.settings.sort_tag }}"
    >
      {%- for product in collection.products -%}
        {% if product.available == true %}
        {% assign lazy_loading = false %}
        {%- if forloop.index > 2 -%}
          {%- assign lazy_loading = true -%} 
          {% assign fetchpriority = 'low' %}
          {% assign lazy_load = "lazy" %}   
        {% elsif  forloop.index <= 2 %}   
          {%- assign lazy_loading = true -%} 
          {% assign lazy_load = "eager" %}  
          {% assign fetchpriority = 'high' %}
        {%- endif -%}

        <li
          class="{{ forloop.index }} grid__item{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {% if settings.animations_reveal_on_scroll %}
          data-cascade
          style="--animation-order: {{ forloop.index }};"
          {% endif %}
          data-product-id="{{ product.id }}"
        >
          
            {% render 'mm-product-card',
              card_product: product,
              media_aspect_ratio: section.settings.image_ratio,
              image_shape: section.settings.image_shape,
              show_secondary_image: section.settings.show_secondary_image,
              show_vendor: section.settings.show_vendor,
              show_rating: section.settings.show_rating,
              lazy_load: lazy_load,
              fetchpriority: fetchpriority,
              show_quick_add: section.settings.enable_quick_add,
              section_id: section.id
            %}

        </li>
                    {% endif %}
      {%- endfor -%}
    </ul>
    {% if paginate.next %}
      <div id="magepow-Pagination" style="margin-bottom: 20px;" data-total-pages="{{ paginate.parts.size }}">
          <a href="{{ paginate.next.url }}"></a>
      </div>
    {% endif %}
  {% else %}
    <p>No products found in this collection.</p>
  {% endif %}
{%- endpaginate -%}
